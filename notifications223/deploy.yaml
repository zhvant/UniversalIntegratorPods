--- 
apiVersion: v1
kind: Pod
metadata: 
  name: notifications223
  labels: 
    app: main
    env: dev
    owner: AntonZhivnov
    tier: backend 
spec:
  volumes: 
    - name: downloads
      emptyDir: {}
    - name: configs
      emptyDir: {}
      #gitRepo:
        #repository: "https://github.com/zhvant/UniversalIntegratorPods.git"

  initContainers:
    - name: git-cloner
      image: alpine/git
      args:
          - clone
          - https://github.com/zhvant/UniversalIntegratorPods.git
          - /app/configs
      volumeMounts:
      - mountPath: /app/configs
        name: configs

  containers: 
  
    - image: zhvant/universalintegrator
      name: container-downloader
      volumeMounts: 
        - mountPath: /app/downloads
          name: downloads
        - mountPath: /app/configs
          name: configs
      env:
        - name: PRESTART_COMMAND
          value: "/bin/cp /app/configs/$HOSTNAME/container-archiver/Config.json /app/Config.json" 
      #lifecycle:
      #  postStart:
      #    exec:
      #      command: ["/bin/sh", "-c", "/bin/cp /app/configs/$HOSTNAME/container-downloader/Config.json /app/Config.json"]

    - image: zhvant/universalintegrator
      name: container-archiver
      volumeMounts: 
        - mountPath: /app/downloads
          name: downloads
        - mountPath: /app/configs
          name: configs
      env:
        - name: PRESTART_COMMAND
          value: "/bin/cp /app/configs/$HOSTNAME/container-archiver/Config.json /app/Config.json"    
      
      
      
      #lifecycle:
      #  postStart:
      #    exec:
      #      command: ["/bin/sh", "-c", "/bin/cp /app/configs/$HOSTNAME/container-archiver/Config.json /app/Config.json"]



